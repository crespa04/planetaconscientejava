<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Login | Planeta Consciente</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/login.css}">
</head>
<body>
    <div class="login-container">
        <h1>Iniciar Sesión</h1>
        
        <!-- Mensaje de error de autenticación -->
        <div th:if="${param.error}" class="message error">
            Correo electrónico o contraseña incorrectos
        </div>
        
        <!-- Mensaje de logout -->
        <div th:if="${param.logout}" class="message info">
            Has cerrado sesión correctamente
        </div>
        
        <!-- Mensaje de registro exitoso (CORREGIDO) -->
        <div th:if="${param.success}" class="message success">
            ¡Registro completado! Por favor revisa tu email para confirmar tu cuenta.
        </div>
        
        <!-- Mensaje de cuenta verificada -->
        <div th:if="${param.verified}" class="message success">
            ¡Cuenta verificada exitosamente! Ya puedes iniciar sesión.
        </div>
        
        <!-- Mensaje de recuperación enviada -->
        <div th:if="${param.resetSent}" class="message info">
            Si el correo existe en nuestro sistema, le enviaremos un enlace de recuperación a dicho correo.
        </div>
        
        <!-- Mensaje de contraseña cambiada -->
        <div th:if="${param.passwordChanged}" class="message success">
            Contraseña cambiada exitosamente. Ya puedes iniciar sesión.
        </div>

        <!-- Mensaje de error desde flash attributes (para errores en registro) -->
        <div th:if="${errorMessage}" class="message error" th:text="${errorMessage}">
        </div>

        <form th:action="@{/login}" method="post">
            <div class="form-group">
                <label for="username">Correo Electrónico</label>
                <input type="email" id="username" name="username" placeholder="Ingresa tu correo electrónico" required>
            </div>
            
            <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="password" id="password" name="password" placeholder="Ingresa tu contraseña" required>
            </div>
            
            <button type="submit">Iniciar Sesión</button>
        </form>

        <div style="text-align: center; margin: 1rem 0;">
            <a th:href="@{/forgot-password}" 
            style="color: var(--primary-color); text-decoration: none; font-size: 0.9rem;">
                ¿Olvidaste tu contraseña?
            </a>
        </div>
        
        <a th:href="@{/register}" class="register-link">¿No tienes cuenta? Regístrate</a>
    </div>
    
    <!-- Decoración ambiental -->
    <svg class="leaf-decoration leaf-1" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path fill="var(--primary-color)" d="M416 127.1C416 247.4 319.4 344 200 344C158.8 344 120.3 331.3 88.53 309.7C83.42 306.1 77.42 307.7 73.7 312.8C70.06 317.9 71.67 323.9 76.78 327.6C112.3 353.1 154.8 368 200 368C337.2 368 448 257.2 448 120C448 74.84 433.1 32.31 407.6 3.223C403.9-1.886 397.9-3.497 392.8 .1487C387.7 3.795 386.1 9.793 389.7 14.89C411.3 46.72 424 85.22 424 127.1H416z"/>
    </svg>
    
    <svg class="leaf-decoration leaf-2" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path fill="var(--secondary-color)" d="M272 96c26.5 0 48-21.5 48-48S298.5 0 272 0s-48 21.5-48 48s21.5 48 48 48zm-64 160c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm160 0c0 26.5 21.5 48 48 48s48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48zm-96 128c-26.5 0-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48s-21.5-48-48-48z"/>
    </svg>
</body>
</html>